通过约定文件 `layout.(js|jsx|tsx)` 和 `template.(js|jsx|tsx)`，您可以创建路由之间共享的用户界面。

## layout
`layout` 是多个路径共享的用户界面。在导航过程中，`layout`会**保留状态**，保持交互性，并且**不会重新渲染**。`layout`也可以嵌套。

![layout](/public/layout-special-file.avif)

您可以通过 `layout.(js|jsx|tsx)` 文件导出一个 `React` 组件来定义布局。该组件应接受一个 `children prop`，该 `prop` 将在呈现过程中填充子布局（如果存在）或页面。

!!! warn "根布局定义在应用程序目录的顶层，适用于所有路由。该布局是必需的，必须包含 html 和 body 标记，允许您修改服务器返回的初始 HTML。"

```jsx
  import type { Metadata } from "next";
  import { Inter } from "next/font/google";
  import "./globals.css";

  const inter = Inter({ subsets: ["latin"] });

  export const metadata: Metadata = {
    title: "Create Next App",
    description: "Generated by create next app",
  };

  export default function RootLayout({
    children,
  }: Readonly<{
    children: React.ReactNode;
  }>) {
    return (
      <html lang="en">
        <body className={inter.className}>{children}</body>
      </html>
    );
  }
```

### 布局嵌套
![布局嵌套](/public/nested-layouts-ui.avif)
上述目录结构根布局下会包裹dashboard布局。

### 总结
1. 只有根布局可以包含 `<html>` 和 `<body>` 标记。
2. 当`layout`和`page`文件定义在同一个文件夹中时，布局将包裹页面。
3. 默认情况下，布局是服务器组件，但也可以设置为客户端组件。
4. 布局可以获取数据。(数据获取篇讲解)
5. 在父布局和子布局之间传递数据是**不可能的**。不过，您可以在路由中多次获取相同的数据，`React` 会自动对请求进行去重处理，而不会影响性能。
6. 布局无法访问路径名，[了解更多信息](https://nextjs.org/docs/app/api-reference/file-conventions/layout#layouts-do-not-receive-searchparams)。但导入的客户端组件可以使用 `usePathname` 钩子访问路径名。
7. 布局无法访问自身下方的路由段。要访问所有路由段，可以在客户端组件中使用 `useSelectedLayoutSegment` 或 `useSelectedLayoutSegments`。


## template
模板与布局类似，都是对子布局或页面进行包装。与跨路径持久存在并保持状态的布局不同，模板会在导航时为其每个子节点创建一个新实例。这意味着，当用户在共享模板的路由之间导航时，子路由的新实例会被加载，DOM 元素会被重新创建，**状态不会保留**在客户端组件中，效果也会重新同步。

模板可以通过从 `template.(js|jsx|tsx)` 文件导出一个默认的 `React` 组件来定义。该组件应接受一个子属性。
